
<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<head>

<title>Convertisseur - Mots-clés</title>
</head>
<body style="background-color:#dcd7d5";>
<h1>L'extracteur à mots clés 2000® (Shutterstock uniquement)</h1>
<br>

<select id="attribution">
   <option value="royalty-free" selected="selected">Royalty-free</option>
   <option value="editorial">editorial</option>
</select>

<select id="format">
   <option value="horizontal" selected="selected">Horizontal</option>
   <option value="vertical">Vertical</option>
</select>

<br>
<form>
<h2>Veuillez coller le code-source.</h2>
<p><textarea style="background-color:#eeeeee"; id="texte" rows="8" cols="60"></textarea></p>
<input type="button" value="Soumettre" onclick="SubmitFonc()">
</form>

<br>
<br>

<p><textarea style="background-color:#eeeeee"; id="texte_sortie" rows="8" cols="60"></textarea></p>

<script  type='text/javascript'>

document.getElementById("texte");
texte.select();

function SubmitFonc() {     // début de la fonction liée au bouton

var code_source = document.getElementById("texte").value;


if (code_source == "") {

   keywords = [];

   var tag1 = document.getElementById("format").value;
   var tag2 = document.getElementById("attribution").value;

   keywords.unshift(tag1);
   keywords.unshift(tag2);

   keywords = keywords.toString();
   keywords = keywords.replace(/,/g, ", ");



   document.getElementById('texte_sortie');
   texte_sortie.innerText = keywords;
   return true; }


code_source = code_source.replace(/\\/g, "");
code_source = code_source.replace(/"/g, "");
code_source = code_source.replace(/:/g, " ");
code_source = code_source.replace(/,/g, " ");

code_source = code_source.split(' ');

if (code_source.length < 1000) {
   alert("Il semblerait qu'il y ait une erreur avec le code source");
   return true;   }

var position = code_source.indexOf("keywords");

position = position + 1;

for (var i = position; i < (position + 155); i++)
{
    if (code_source[i].indexOf(']') != -1)
    {
       var end = i;
       break;
    }

   if (end == i) break;
   else if (i == (position + 150)) {
                 alert("Il semblerait qu'il y ait une erreur avec le code source");
                 return true; }

}

var check = end - position;


keywords = code_source.slice(position, end);

var tag1 = document.getElementById("format").value;
var tag2 = document.getElementById("attribution").value;

keywords.unshift(tag1);
keywords.unshift(tag2);

keywords = keywords.toString();
keywords = keywords.replace(/[\[\]']+/g, "");
keywords = keywords.replace(/,/g, ", ");



document.getElementById('texte_sortie');
texte_sortie.innerText = keywords;


                                        }                                   // fin de la fonction principale liée au bouton



</script>

<h2>Instructions</h2>
<p>
1. Rechercher une image sur Shutterstock.
<br>
2. S'assurer d'être sur le lien en anglais.
<br>
3. Faire «Ctrl + u», puis «Ctrl + a» et «Ctrl + c»*.
<br>
4. Aller sur la page du script et sélectionner manuellement les paires «Royalty-free/editorial» et «Horizontal/vertical».
<br>
5. Coller le code-source et cliquer sur «Soumettre».
<br>
<br>

Note: si l'image contient plus de 150 mots-clés, ce qui m'étonnerait, le processus est arrêté et un message d'erreur s'affiche. Cela pourrait arriver aussi si les données d'une image sont structurées différemment des modèles que j'ai utilisés.
Merci de me communiquer les images dont l'extraction des mots-clés a échoué afin que je puisse améliorer mon script.
<br>
<br>
*Rccourcis testés sur Windows. Sinon, faites clic-droit, «afficher le code-source», puis sélectionnez-le en entier pour le coller ensuite sur la page du script.
</p>

</body>
</html>
